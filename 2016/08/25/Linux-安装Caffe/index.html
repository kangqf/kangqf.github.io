<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Linux 安装Caffe | kblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本文按照网上教程在Ubuntu 14.04 环境下安装caffe的记录，其中安装的OpenCV 2.4.13 使用的CUDA是7.0。在这里首先将遇到的一些问题和环境不一样的地方例举如下(如果遇到其他的问题可以参考这里)： 安装libboost-all-de应该改成libboost1.55-all-dev 在禁用独立显卡来安装CUDA后应该再次打开独立显卡。 安装CUDNN的指令  12sudo">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 安装Caffe">
<meta property="og:url" content="http://kangqingfei.cn/2016/08/25/Linux-%E5%AE%89%E8%A3%85Caffe/index.html">
<meta property="og:site_name" content="kblog">
<meta property="og:description" content="本文按照网上教程在Ubuntu 14.04 环境下安装caffe的记录，其中安装的OpenCV 2.4.13 使用的CUDA是7.0。在这里首先将遇到的一些问题和环境不一样的地方例举如下(如果遇到其他的问题可以参考这里)： 安装libboost-all-de应该改成libboost1.55-all-dev 在禁用独立显卡来安装CUDA后应该再次打开独立显卡。 安装CUDNN的指令  12sudo">
<meta property="og:locale">
<meta property="article:published_time" content="2016-08-25T13:34:47.000Z">
<meta property="article:modified_time" content="2022-09-14T18:03:38.040Z">
<meta property="article:author" content="kangqingfei">
<meta property="article:tag" content="caffe">
<meta property="article:tag" content="DL">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">


  <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
  <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet">
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="kblog" type="application/atom+xml">
</head>
<style>
    .pace .pace-progress {
    	background: #1E92FB; /*进度条颜色*/
    	height: 2px;
    }
    .pace .pace-progress-inner {
     	box-shadow: 0 0 10px #1E92FB, 0 0 5px #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
    	border-top-color: #1E92FB;	/*上边框颜色*/
    	border-left-color: #1E92FB;	/*左边框颜色*/
    }
    .profilepic:hover { /*头像动画效果*/
    -webkit-animation: shake 1s;
    animation: shake 1s;
    };
</style>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/assest/images/kqf.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						<li>分类</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/about.html">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/kangqf" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:i@kangqingfei.cn" title="mail">mail</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/ACM/" style="font-size: 10px;">ACM</a> <a href="/tags/ARM/" style="font-size: 11.43px;">ARM</a> <a href="/tags/Altium-Designer/" style="font-size: 11.43px;">Altium Designer</a> <a href="/tags/BananaPro/" style="font-size: 17.14px;">BananaPro</a> <a href="/tags/BootStrap/" style="font-size: 10px;">BootStrap</a> <a href="/tags/DHCP/" style="font-size: 10px;">DHCP</a> <a href="/tags/DL/" style="font-size: 10px;">DL</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Docker-%E5%85%A5%E9%97%A8/" style="font-size: 10px;">Docker 入门</a> <a href="/tags/HG255D/" style="font-size: 10px;">HG255D</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/IP/" style="font-size: 10px;">IP</a> <a href="/tags/LIS/" style="font-size: 10px;">LIS</a> <a href="/tags/LRS/" style="font-size: 10px;">LRS</a> <a href="/tags/Makefile/" style="font-size: 10px;">Makefile</a> <a href="/tags/OpenWrt/" style="font-size: 11.43px;">OpenWrt</a> <a href="/tags/QML/" style="font-size: 10px;">QML</a> <a href="/tags/Qt/" style="font-size: 11.43px;">Qt</a> <a href="/tags/VMware/" style="font-size: 10px;">VMware</a> <a href="/tags/VPS/" style="font-size: 10px;">VPS</a> <a href="/tags/XHR2/" style="font-size: 10px;">XHR2</a> <a href="/tags/archlinux/" style="font-size: 11.43px;">archlinux</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/caffe/" style="font-size: 10px;">caffe</a> <a href="/tags/cplusplus/" style="font-size: 10px;">cplusplus</a> <a href="/tags/cpp/" style="font-size: 11.43px;">cpp</a> <a href="/tags/frp/" style="font-size: 10px;">frp</a> <a href="/tags/g/" style="font-size: 10px;">g++</a> <a href="/tags/gcc/" style="font-size: 10px;">gcc</a> <a href="/tags/gdb/" style="font-size: 10px;">gdb</a> <a href="/tags/git/" style="font-size: 11.43px;">git</a> <a href="/tags/hackintosh/" style="font-size: 10px;">hackintosh</a> <a href="/tags/hash/" style="font-size: 10px;">hash</a> <a href="/tags/hexo/" style="font-size: 15.71px;">hexo</a> <a href="/tags/i3/" style="font-size: 10px;">i3</a> <a href="/tags/jekyll/" style="font-size: 10px;">jekyll</a> <a href="/tags/job/" style="font-size: 18.57px;">job</a> <a href="/tags/kindle/" style="font-size: 10px;">kindle</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/linux/" style="font-size: 11.43px;">linux</a> <a href="/tags/make/" style="font-size: 10px;">make</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/media/" style="font-size: 10px;">media</a> <a href="/tags/mongo/" style="font-size: 10px;">mongo</a> <a href="/tags/network/" style="font-size: 11.43px;">network</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/note/" style="font-size: 14.29px;">note</a> <a href="/tags/root-fs/" style="font-size: 10px;">root-fs</a> <a href="/tags/sort/" style="font-size: 10px;">sort</a> <a href="/tags/tencent/" style="font-size: 11.43px;">tencent</a> <a href="/tags/tmux/" style="font-size: 12.86px;">tmux</a> <a href="/tags/typora/" style="font-size: 11.43px;">typora</a> <a href="/tags/ubuntu/" style="font-size: 11.43px;">ubuntu</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 12.86px;">动态规划</a> <a href="/tags/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/" style="font-size: 10px;">后缀数组</a> <a href="/tags/%E5%A4%B4%E6%9D%A1/" style="font-size: 10px;">头条</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 14.29px;">字符串</a> <a href="/tags/%E5%AE%89%E5%85%A8-%E6%B8%97%E9%80%8F/" style="font-size: 10px;">安全 渗透</a> <a href="/tags/%E5%B0%81%E8%A3%85/" style="font-size: 10px;">封装</a> <a href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" style="font-size: 15.71px;">嵌入式</a> <a href="/tags/%E6%AF%95%E8%AE%BE/" style="font-size: 20px;">毕设</a> <a href="/tags/%E6%B1%87%E6%80%BB/" style="font-size: 10px;">汇总</a> <a href="/tags/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" style="font-size: 10px;">滑动窗口</a> <a href="/tags/%E7%AC%94%E8%AF%95%E9%A2%98/" style="font-size: 10px;">笔试题</a> <a href="/tags/%E7%BB%98%E5%9B%BE/" style="font-size: 10px;">绘图</a> <a href="/tags/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/" style="font-size: 10px;">编辑距离</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 10px;">翻译</a> <a href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" style="font-size: 10px;">背包问题</a>
					</div>
				</section>
				

				
				<section class="switch-part switch-part3">
					<div class="widget tagcloud" id="js-tagcloud">
						<ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ACM/">ACM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/basis/">basis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/config/">config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jobs/">jobs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/notes/">notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/test/">test</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%89%E5%85%A8/">安全</a></li></ul>
					</div>
				</section>
				

				

				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
			
				<img src="/assest/images/kqf.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/about.html">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/kangqf" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:i@kangqingfei.cn" title="mail">mail</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>
	</div>
</nav>

      <div class="body-wrap"><article id="post-Linux-安装Caffe" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/25/Linux-%E5%AE%89%E8%A3%85Caffe/" class="article-date">
  	<time datetime="2016-08-25T13:34:47.000Z" itemprop="datePublished">2016-08-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Linux 安装Caffe
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/caffe/" rel="tag">caffe</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/config/">config</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="本文按照网上教程在Ubuntu-14-04-环境下安装caffe的记录，其中安装的OpenCV-2-4-13-使用的CUDA是7-0。在这里首先将遇到的一些问题和环境不一样的地方例举如下-如果遇到其他的问题可以参考这里-："><a href="#本文按照网上教程在Ubuntu-14-04-环境下安装caffe的记录，其中安装的OpenCV-2-4-13-使用的CUDA是7-0。在这里首先将遇到的一些问题和环境不一样的地方例举如下-如果遇到其他的问题可以参考这里-：" class="headerlink" title="本文按照网上教程在Ubuntu 14.04 环境下安装caffe的记录，其中安装的OpenCV 2.4.13 使用的CUDA是7.0。在这里首先将遇到的一些问题和环境不一样的地方例举如下(如果遇到其他的问题可以参考这里)："></a>本文按照<a target="_blank" rel="noopener" href="https://gist.github.com/bearpaw/c38ef18ec45ba6548ec0">网上教程</a>在Ubuntu 14.04 环境下安装caffe的记录，其中安装的OpenCV 2.4.13 使用的CUDA是7.0。在这里首先将遇到的一些问题和环境不一样的地方例举如下(如果遇到其他的问题可以参考<a target="_blank" rel="noopener" href="http://yongyuan.name/blog/problems-when-configing-caffe.html">这里</a>)：</h2><ol>
<li>安装<code>libboost-all-de</code>应该改成<code>libboost1.55-all-dev</code></li>
<li>在禁用独立显卡来安装CUDA后应该再次打开独立显卡。</li>
<li>安装CUDNN的指令  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp lib64<span class="regexp">/*  /u</span>sr<span class="regexp">/local/</span>cuda<span class="regexp">/lib64/</span></span><br><span class="line">sudo cp include<span class="regexp">/cudnn.h /u</span>sr<span class="regexp">/local/</span>cuda<span class="regexp">/include/</span></span><br></pre></td></tr></table></figure></li>
<li>如下报错  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- Installing <span class="keyword">Dependencies</span></span><br><span class="line">./opencv_install.sh: 第 <span class="number">27</span> 行: <span class="keyword">source</span>: <span class="keyword">dependencies</span>.sh: 文件未找到</span><br></pre></td></tr></table></figure>
  把安装脚本27行 <code>dependencies.sh</code> 改成　<code>./dependencies.sh</code><span id="more"></span></li>
<li>如下报错  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CXX .build_release<span class="regexp">/src/</span>caffe<span class="regexp">/proto/</span>caffe.pb.cc</span><br><span class="line">In <span class="keyword">file</span> included <span class="keyword">from</span> .build_release<span class="regexp">/src/</span>caffe<span class="regexp">/proto/</span>caffe.pb.cc:<span class="number">5</span>:<span class="number">0</span>:</span><br><span class="line">.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/proto/</span>caffe.pb.h:<span class="number">9</span>:<span class="number">42</span>: fatal error: google<span class="regexp">/protobuf/</span>stubs/common.h: 没有那个文件或目录</span><br><span class="line">#<span class="keyword">include</span> &lt;google<span class="regexp">/protobuf/</span>stubs/common.h&gt;</span><br><span class="line">                                        ^</span><br><span class="line">compilation terminated.</span><br><span class="line">make: *** [.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/proto/</span>caffe.pb.o] 错误 <span class="number">1</span></span><br></pre></td></tr></table></figure>
  或  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PROTOC src<span class="regexp">/caffe/</span>proto/caffe.proto</span><br><span class="line">make: protoc：命令未找到</span><br><span class="line">make: *** [.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/proto/</span>caffe.pb.h] 错误 <span class="number">127</span></span><br></pre></td></tr></table></figure>
  安装对应的包<code>sudo apt-get install libprotobuf-dev protobuf-c-compiler protobuf-compiler</code></li>
<li>如下报错  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CXX src<span class="regexp">/caffe/</span>layers/recurrent_layer.cpp</span><br><span class="line">In <span class="keyword">file</span> included <span class="keyword">from</span> .<span class="regexp">/include/</span>caffe/blob.hpp:<span class="number">8</span>:<span class="number">0</span>,</span><br><span class="line">                 <span class="keyword">from</span> src<span class="regexp">/caffe/</span>layers/recurrent_layer.cpp:<span class="number">4</span>:</span><br><span class="line">.<span class="regexp">/include/</span>caffe<span class="regexp">/common.hpp:5:27: fatal error: gflags/g</span>flags.h: 没有那个文件或目录</span><br><span class="line">#<span class="keyword">include</span> &lt;gflags/gflags.h&gt;</span><br><span class="line">                         ^</span><br><span class="line">compilation terminated.</span><br><span class="line">make: *** [.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/layers/</span>recurrent_layer.o] 错误 <span class="number">1</span></span><br></pre></td></tr></table></figure>
  可以看出跟gflags有关，大概推测是gflags没装，于是按照教程把下面的都安装了：</li>
</ol>
<ul>
<li>安装glog&#x2F;gflags&#x2F;lmdb</li>
<li>glog  <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://google-glog.googlecode.<span class="keyword">com</span>/<span class="keyword">files</span>/glog-<span class="number">0.3</span>.<span class="number">3</span>.tar.gz</span><br><span class="line">tar zxvf glog-<span class="number">0.3</span>.<span class="number">3</span>.tar.gz</span><br><span class="line"><span class="keyword">cd</span> glog-<span class="number">0.3</span>.<span class="number">3</span></span><br><span class="line">./configure</span><br><span class="line"><span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install</span><br></pre></td></tr></table></figure></li>
<li>gflags  <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.<span class="keyword">com</span>/schuhschuh/gflags/archive/master.zip</span><br><span class="line">unzip master.zip</span><br><span class="line"><span class="keyword">cd</span> gflags-master</span><br><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="keyword">cd</span> build</span><br><span class="line">export CXXFLAGS=<span class="string">&quot;-fPIC&quot;</span> &amp;&amp; cmake .. &amp;&amp; <span class="keyword">make</span> VERBOSE=<span class="number">1</span></span><br><span class="line"><span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install</span><br></pre></td></tr></table></figure></li>
<li>lmdb  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>torious.org<span class="regexp">//m</span>db/mdb.git</span><br><span class="line">cd mdb<span class="regexp">/libraries/</span>liblmdb</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="7">
<li>clone 报错  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fatal: unable to access <span class="string">&#x27;https://gitorious.org/mdb/mdb.git/&#x27;</span>: server certificate verification failed. CAfile: <span class="regexp">/etc/</span>ssl<span class="regexp">/certs/</span>ca-certificates.crt CRLfile: none</span><br></pre></td></tr></table></figure>
  跳过SSL验证<code>export GIT_SSL_NO_VERIFY=1</code></li>
<li>缺乏头文件报错  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">src<span class="regexp">/caffe/</span>layers/hdf5_output_layer.cpp:<span class="number">3</span>:<span class="number">18</span>: fatal error: hdf5.h: 没有那个文件或目录</span><br><span class="line"> #<span class="keyword">include</span> <span class="string">&quot;hdf5.h&quot;</span></span><br><span class="line">                  ^</span><br><span class="line">compilation terminated.</span><br><span class="line">make: *** [.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/layers/</span>hdf5_output_layer.o] 错误 <span class="number">1</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>首先确保安装了<code>libhdf5-serial-dev libhdf5-dev</code>这两个包</li>
<li>然后<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /usr/lib/x86_64-linux-gnu</span><br><span class="line">sudo <span class="keyword">ln</span> -s libhdf5_serial.<span class="keyword">so</span>.<span class="number">8.0</span>.<span class="number">2</span> libhdf5.<span class="keyword">so</span></span><br><span class="line">sudo <span class="keyword">ln</span> -s libhdf5_serial_hl.<span class="keyword">so</span>.<span class="number">8.0</span>.<span class="number">2</span> libhdf5_hl.<span class="keyword">so</span></span><br></pre></td></tr></table></figure></li>
<li>如果还不行就修改 <code>MakeFile.config</code><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INCLUDE_DIRS := $(PYTHON_INCLUDE) <span class="regexp">/usr/</span>local<span class="regexp">/include /u</span>sr<span class="regexp">/include/</span>hdf5<span class="regexp">/serial/</span> and</span><br><span class="line">LIBRARY_DIRS := $(PYTHON_LIB) <span class="regexp">/usr/</span>local<span class="regexp">/lib /u</span>sr<span class="regexp">/lib /u</span>sr<span class="regexp">/lib/</span>x86_64-linux-gnu<span class="regexp">/hdf5/</span>serial/</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="9">
<li><p>缺乏头文件报错</p>
  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/include/</span>caffe<span class="regexp">/util/</span>db_leveldb.hpp:<span class="number">7</span>:<span class="number">24</span>: fatal error: leveldb/db.h: 没有那个文件或目录</span><br><span class="line">#<span class="keyword">include</span> <span class="string">&quot;leveldb/db.h&quot;</span></span><br><span class="line">                      ^</span><br><span class="line">compilation terminated.</span><br><span class="line">make: *** [.build_release<span class="regexp">/src/</span>caffe<span class="regexp">/util/</span>db.o] 错误 <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>  缺少了google的kv数据库：leveldb，这个在installation.md中的Optional dependencies也提到了。<br>  从这里下载：<a target="_blank" rel="noopener" href="https://github.com/google/leveldb">https://github.com/google/leveldb</a><br>  参考：<a target="_blank" rel="noopener" href="https://techoverflow.net/blog/2012/12/14/compiling-installing-leveldb-on-linux/">https://techoverflow.net/blog/2012/12/14/compiling-installing-leveldb-on-linux/</a><br>  解压后，make<br>  因为没有不支持install，所以，要手工将这些include和生成的lib拷贝到需要的地方。<br>  <code>cp --preserve=links out-shared/libleveldb.so* /usr/local/lib</code>  上面只拷贝了动态库。<br>  &#96;cp -r include&#x2F;leveldb&#x2F; &#x2F;usr&#x2F;local&#x2F;include&#x2F;&#96;&#96;</p>
</li>
<li><p>链接报错</p>
  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LD -o .build_release<span class="regexp">/lib/</span>libcaffe.so.<span class="number">1.0</span>.<span class="number">0</span>-rc3</span><br><span class="line"><span class="regexp">/usr/</span>bin/ld: 找不到 -lsnappy</span><br><span class="line">collect2: error: ld returned <span class="number">1</span> <span class="keyword">exit</span> status</span><br><span class="line">make: *** [.build_release<span class="regexp">/lib/</span>libcaffe.so.<span class="number">1.0</span>.<span class="number">0</span>-rc3] 错误 <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>  缺乏库 <code>sudo apt-get install libsnappy-dev</code></p>
</li>
<li><p>链接报错（存在于自己编译Qt的情况需要自己指定Qt库的路径）</p>
  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CXX<span class="regexp">/LD -o .build_release/</span>tools/upgrade_solver_proto_text.bin</span><br><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/ld: warning: libicui18n.so.56, needed by /</span><span class="regexp">/home/</span>kqf<span class="regexp">/program/</span>Qt5.<span class="number">6.0</span><span class="regexp">/5.6/g</span>cc_64<span class="regexp">/lib/</span>libQt5Core.so.<span class="number">5</span>, not found (<span class="keyword">try</span> using -rpath or -rpath-link)</span><br><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/ld: warning: libicuuc.so.56, needed by /</span><span class="regexp">/home/</span>kqf<span class="regexp">/program/</span>Qt5.<span class="number">6.0</span><span class="regexp">/5.6/g</span>cc_64<span class="regexp">/lib/</span>libQt5Core.so.<span class="number">5</span>, not found (<span class="keyword">try</span> using -rpath or -rpath-link)</span><br><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/ld: warning: libicudata.so.56, needed by /</span><span class="regexp">/home/</span>kqf<span class="regexp">/program/</span>Qt5.<span class="number">6.0</span><span class="regexp">/5.6/g</span>cc_64<span class="regexp">/lib/</span>libQt5Core.so.<span class="number">5</span>, not found (<span class="keyword">try</span> using -rpath or -rpath-link)</span><br></pre></td></tr></table></figure>
<p>  把Qt库的路径加入到链接库的搜索路径中<code>export LD_LIBRARY_PATH=/home/kqf/program/Qt5.6.0/5.6/gcc_64/lib:$LD_LIBRARY_PATH</code>。</p>
</li>
</ol>
<h1 id="现将原文copy如下："><a href="#现将原文copy如下：" class="headerlink" title="现将原文copy如下："></a>现将原文copy如下：</h1><h1 id="Caffe-Ubuntu-14-04-64bit-CUDA-6-5-配置说明"><a href="#Caffe-Ubuntu-14-04-64bit-CUDA-6-5-配置说明" class="headerlink" title="Caffe + Ubuntu 14.04 64bit + CUDA 6.5 配置说明"></a>Caffe + Ubuntu 14.04 64bit + CUDA 6.5 配置说明</h1><p>本步骤能实现用Intel核芯显卡来进行显示， 用NVIDIA GPU进行计算。</p>
<h2 id="1-安装开发所需的依赖包"><a href="#1-安装开发所需的依赖包" class="headerlink" title="1. 安装开发所需的依赖包"></a>1. 安装开发所需的依赖包</h2><p>安装开发所需要的一些基本包</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential  <span class="comment"># basic requirement</span></span><br><span class="line">sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev libgflags-dev libgoogle-glog-dev liblmdb-dev protobuf-compiler <span class="comment">#required by caffe</span></span><br></pre></td></tr></table></figure>

<h2 id="2-安装CUDA及驱动"><a href="#2-安装CUDA及驱动" class="headerlink" title="2. 安装CUDA及驱动"></a>2. 安装CUDA及驱动</h2><h3 id="2-1-准备工作"><a href="#2-1-准备工作" class="headerlink" title="2.1 准备工作"></a>2.1 准备工作</h3><p>在关闭桌面管理 lightdm 的情况下安装驱动似乎可以实现Intel 核芯显卡 来显示 + NVIDIA 显卡来计算。具体步骤如下：</p>
<ol>
<li><p>首先在BIOS设置里选择用Intel显卡来显示或作为主要显示设备</p>
</li>
<li><p>进入Ubuntu， 按 ctrl+alt+F1 进入tty， 登录tty后输入如下命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service lightdm stop</span><br></pre></td></tr></table></figure></li>
</ol>
<p>该命令会关闭lightdm。如果你使用 gdm或者其他的desktop manager, 请在安装NVIDIA驱动前关闭他。</p>
<h3 id="2-2-下载deb包及安装CUDA"><a href="#2-2-下载deb包及安装CUDA" class="headerlink" title="2.2 下载deb包及安装CUDA"></a>2.2 下载deb包及安装CUDA</h3><p>使用deb包安装CUDA及驱动能省去很多麻烦(参见<a target="_blank" rel="noopener" href="http://developer.download.nvidia.com/compute/cuda/6_5/rel/docs/CUDA_Getting_Started_Linux.pdf">CUDA Starting Guide</a>)。下载对应于你系统的<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-downloads">CUDA deb包</a>, 然后用下列命令添加软件源</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i cuda-repo-&lt;distro&gt;_&lt;version&gt;_&lt;architecture&gt;.deb</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>然后用下列命令安装CUDA</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cuda</span><br></pre></td></tr></table></figure>
<p>安装完成后 reboot.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>

<h3 id="2-3-安装cuDNN"><a href="#2-3-安装cuDNN" class="headerlink" title="2.3 安装cuDNN"></a>2.3 安装cuDNN</h3><p><strong>(03-25: 今天下最新的caffe回来发现编译不过啊一直CUDNN报错浪费了我几个小时没搞定! 后来才发现caffe15小时前的更新开始使用cudnn v2, 但是官网上并没有明显提示!!! 坑爹啊!)</strong><br>cuDNN能加速caffe中conv及pooling的计算。首先下载cuDNN, 然后执行下列命令解压并安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf cudnn-6.5-linux-x64-v2.tgz</span><br><span class="line"><span class="built_in">cd</span> cudnn-6.5-linux-x64-v2</span><br><span class="line">sudo <span class="built_in">cp</span> lib* /usr/local/cuda/lib64/</span><br><span class="line">sudo <span class="built_in">cp</span> cudnn.h /usr/local/cuda/include/</span><br></pre></td></tr></table></figure>
<p>更新软链接</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/cuda/lib64/</span><br><span class="line">sudo <span class="built_in">rm</span> -rf libcudnn.so libcudnn.so.6.5</span><br><span class="line">sudo <span class="built_in">ln</span> -s libcudnn.so.6.5.48 libcudnn.so.6.5</span><br><span class="line">sudo <span class="built_in">ln</span> -s libcudnn.so.6.5 libcudnn.so</span><br></pre></td></tr></table></figure>

<h3 id="2-4-设置环境变量"><a href="#2-4-设置环境变量" class="headerlink" title="2.4 设置环境变量"></a>2.4 设置环境变量</h3><p>安装完成后需要在<code>/etc/profile</code>中添加环境变量, 在文件最后添加:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PATH=/usr/local/cuda/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH</span><br></pre></td></tr></table></figure>
<p>保存后, 执行下列命令, 使环境变量立即生效</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> <span class="regexp">/etc/</span>profile</span><br></pre></td></tr></table></figure>
<p>同时需要添加lib库路径： 在 <code>/etc/ld.so.conf.d/</code>加入文件 <code>cuda.conf</code>, 内容如下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/cuda/lib64</span><br></pre></td></tr></table></figure>
<p>保存后，执行下列命令使之立刻生效</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>


<h2 id="3-安装CUDA-SAMPLE"><a href="#3-安装CUDA-SAMPLE" class="headerlink" title="3. 安装CUDA SAMPLE"></a>3. 安装CUDA SAMPLE</h2><p>进入<code>/usr/local/cuda/samples</code>, 执行下列命令来build samples</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make all -j8</span><br></pre></td></tr></table></figure>
<p>整个过程大概10分钟左右, 全部编译完成后， 进入 <code>samples/bin/x86_64/linux/release</code>, 运行deviceQuery</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./deviceQuery</span><br></pre></td></tr></table></figure>
<p>如果出现显卡信息， 则驱动及显卡安装成功：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">./deviceQuery</span> <span class="string">Starting...</span></span><br><span class="line"></span><br><span class="line"> <span class="string">CUDA</span> <span class="string">Device</span> <span class="string">Query</span> <span class="string">(Runtime</span> <span class="string">API)</span> <span class="string">version</span> <span class="string">(CUDART</span> <span class="string">static</span> <span class="string">linking)</span></span><br><span class="line"></span><br><span class="line"><span class="string">Detected</span> <span class="number">1</span> <span class="string">CUDA</span> <span class="string">Capable</span> <span class="string">device(s)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Device 0:</span> <span class="string">&quot;GeForce GTX 670&quot;</span></span><br><span class="line">  <span class="string">CUDA</span> <span class="string">Driver</span> <span class="string">Version</span> <span class="string">/</span> <span class="string">Runtime</span> <span class="string">Version</span>          <span class="number">6.5</span> <span class="string">/</span> <span class="number">6.5</span></span><br><span class="line">  <span class="attr">CUDA Capability Major/Minor version number:</span>    <span class="number">3.0</span></span><br><span class="line">  <span class="attr">Total amount of global memory:</span>                 <span class="number">4095 </span><span class="string">MBytes</span> <span class="string">(4294246400</span> <span class="string">bytes)</span></span><br><span class="line">  <span class="string">(</span> <span class="number">7</span><span class="string">)</span> <span class="string">Multiprocessors,</span> <span class="string">(192)</span> <span class="attr">CUDA Cores/MP:</span>     <span class="number">1344 </span><span class="string">CUDA</span> <span class="string">Cores</span></span><br><span class="line">  <span class="attr">GPU Clock rate:</span>                                <span class="number">1098 </span><span class="string">MHz</span> <span class="string">(1.10</span> <span class="string">GHz)</span></span><br><span class="line">  <span class="attr">Memory Clock rate:</span>                             <span class="number">3105 </span><span class="string">Mhz</span></span><br><span class="line">  <span class="attr">Memory Bus Width:</span>                              <span class="number">256</span><span class="string">-bit</span></span><br><span class="line">  <span class="attr">L2 Cache Size:</span>                                 <span class="number">524288</span> <span class="string">bytes</span></span><br><span class="line">  <span class="string">Maximum</span> <span class="string">Texture</span> <span class="string">Dimension</span> <span class="string">Size</span> <span class="string">(x,y,z)</span>         <span class="string">1D=(65536),</span> <span class="string">2D=(65536,</span> <span class="number">65536</span><span class="string">),</span> <span class="string">3D=(4096,</span> <span class="number">4096</span><span class="string">,</span> <span class="number">4096</span><span class="string">)</span></span><br><span class="line">  <span class="string">Maximum</span> <span class="string">Layered</span> <span class="string">1D</span> <span class="string">Texture</span> <span class="string">Size,</span> <span class="string">(num)</span> <span class="string">layers</span>  <span class="string">1D=(16384),</span> <span class="number">2048 </span><span class="string">layers</span></span><br><span class="line">  <span class="string">Maximum</span> <span class="string">Layered</span> <span class="string">2D</span> <span class="string">Texture</span> <span class="string">Size,</span> <span class="string">(num)</span> <span class="string">layers</span>  <span class="string">2D=(16384,</span> <span class="number">16384</span><span class="string">),</span> <span class="number">2048 </span><span class="string">layers</span></span><br><span class="line">  <span class="attr">Total amount of constant memory:</span>               <span class="number">65536</span> <span class="string">bytes</span></span><br><span class="line">  <span class="attr">Total amount of shared memory per block:</span>       <span class="number">49152</span> <span class="string">bytes</span></span><br><span class="line">  <span class="attr">Total number of registers available per block:</span> <span class="number">65536</span></span><br><span class="line">  <span class="attr">Warp size:</span>                                     <span class="number">32</span></span><br><span class="line">  <span class="attr">Maximum number of threads per multiprocessor:</span>  <span class="number">2048</span></span><br><span class="line">  <span class="attr">Maximum number of threads per block:</span>           <span class="number">1024</span></span><br><span class="line">  <span class="string">Max</span> <span class="string">dimension</span> <span class="string">size</span> <span class="string">of</span> <span class="string">a</span> <span class="string">thread</span> <span class="string">block</span> <span class="string">(x,y,z):</span> <span class="string">(1024,</span> <span class="number">1024</span><span class="string">,</span> <span class="number">64</span><span class="string">)</span></span><br><span class="line">  <span class="string">Max</span> <span class="string">dimension</span> <span class="string">size</span> <span class="string">of</span> <span class="string">a</span> <span class="string">grid</span> <span class="string">size</span>    <span class="string">(x,y,z):</span> <span class="string">(2147483647,</span> <span class="number">65535</span><span class="string">,</span> <span class="number">65535</span><span class="string">)</span></span><br><span class="line">  <span class="attr">Maximum memory pitch:</span>                          <span class="number">2147483647</span> <span class="string">bytes</span></span><br><span class="line">  <span class="attr">Texture alignment:</span>                             <span class="number">512</span> <span class="string">bytes</span></span><br><span class="line">  <span class="attr">Concurrent copy and kernel execution:</span>          <span class="literal">Yes</span> <span class="string">with</span> <span class="number">1</span> <span class="string">copy</span> <span class="string">engine(s)</span></span><br><span class="line">  <span class="attr">Run time limit on kernels:</span>                     <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Integrated GPU sharing Host Memory:</span>            <span class="literal">No</span></span><br><span class="line">  <span class="attr">Support host page-locked memory mapping:</span>       <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Alignment requirement for Surfaces:</span>            <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Device has ECC support:</span>                        <span class="string">Disabled</span></span><br><span class="line">  <span class="string">Device</span> <span class="string">supports</span> <span class="string">Unified</span> <span class="string">Addressing</span> <span class="string">(UVA):</span>      <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Device PCI Bus ID / PCI location ID:</span>           <span class="number">1</span> <span class="string">/</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">Compute Mode:</span></span><br><span class="line">     <span class="string">&lt;</span> <span class="string">Default</span> <span class="string">(multiple</span> <span class="string">host</span> <span class="string">threads</span> <span class="string">can</span> <span class="string">use</span> <span class="string">::cudaSetDevice()</span> <span class="string">with</span> <span class="string">device</span> <span class="string">simultaneously)</span> <span class="string">&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">deviceQuery,</span> <span class="string">CUDA</span> <span class="string">Driver</span> <span class="string">=</span> <span class="string">CUDART,</span> <span class="string">CUDA</span> <span class="string">Driver</span> <span class="string">Version</span> <span class="string">=</span> <span class="number">6.5</span><span class="string">,</span> <span class="string">CUDA</span> <span class="string">Runtime</span> <span class="string">Version</span> <span class="string">=</span> <span class="number">6.5</span><span class="string">,</span> <span class="string">NumDevs</span> <span class="string">=</span> <span class="number">1</span><span class="string">,</span> <span class="string">Device0</span> <span class="string">=</span> <span class="string">GeForce</span> <span class="string">GTX</span> <span class="number">670</span></span><br><span class="line"><span class="string">Result</span> <span class="string">=</span> <span class="string">PASS</span></span><br></pre></td></tr></table></figure>

<h2 id="4-安装Intel-MKL-或Atlas"><a href="#4-安装Intel-MKL-或Atlas" class="headerlink" title="4. 安装Intel MKL 或Atlas"></a>4. 安装Intel MKL 或Atlas</h2><p>如果没有Intel MKL， 可以用下列命令安装免费的atlas</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libatlas-base-dev</span><br></pre></td></tr></table></figure>

<p>如果有mkl安装包，首先解压安装包，下面有一个install_GUI.sh文件， 执行该文件，会出现图形安装界面，根据说明一步一步执行即可。</p>
<p><em>注意</em>： 安装完成后需要添加library路径, 创建<code>/etc/ld.so.conf.d/intel_mkl.conf</code>文件， 在文件中添加内容</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/opt/i</span>ntel/lib</span><br><span class="line"><span class="regexp">/opt/i</span>ntel<span class="regexp">/mkl/</span>lib/intel64</span><br></pre></td></tr></table></figure>
<p>注意把路径替换成自己的安装路径。 编辑完后执行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>

<h3 id="5-安装OpenCV-Optional，-如果运行caffe时opencv报错，-可以重新按照此步骤安装"><a href="#5-安装OpenCV-Optional，-如果运行caffe时opencv报错，-可以重新按照此步骤安装" class="headerlink" title="5. 安装OpenCV (Optional， 如果运行caffe时opencv报错， 可以重新按照此步骤安装)"></a>5. 安装OpenCV (Optional， 如果运行caffe时opencv报错， 可以重新按照此步骤安装)</h3><p>虽然我们已经安装了<code>libopencv-dev </code>, 但该库似乎会导致<a target="_blank" rel="noopener" href="http://www.cnblogs.com/platero/p/4141063.html">libtiff的相关问题</a>, 所以我们需要从源代码build 自己的版本。这个尽量不要手动安装.</p>
<h4 id="安装2-4-10-推荐"><a href="#安装2-4-10-推荐" class="headerlink" title="安装2.4.10 (推荐)"></a>安装2.4.10 (推荐)</h4><ol>
<li>下载<a target="_blank" rel="noopener" href="https://github.com/bearpaw/Install-OpenCV">安装脚本</a></li>
<li>进入目录 <code>Install-OpenCV/Ubuntu/2.4</code></li>
<li>执行脚本<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./opencv2_4_10.sh</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="安装2-4-9-deprecated"><a href="#安装2-4-9-deprecated" class="headerlink" title="安装2.4.9 (deprecated)"></a>安装2.4.9 (deprecated)</h4><p>Github上有人已经写好了完整的<a target="_blank" rel="noopener" href="https://github.com/jayrambhia/Install-OpenCV">安装脚本</a>, 能自动安装所有dependencies. 下载该脚本，进入<code>Ubuntu/2.4</code> 目录, 给所有shell脚本加上可执行权限</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x *.sh</span><br></pre></td></tr></table></figure>
<p>修改脚本<code>opencv2_4_X.sh</code>, 在cmake中加入参数</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-D <span class="attribute">BUILD_TIFF</span>=ON</span><br></pre></td></tr></table></figure>
<p>然后安装（当前为2.4.9）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./opencv2_4_9.sh</span><br></pre></td></tr></table></figure>
<p>脚本会自动安装依赖项，下载安装包，编译并安装OpenCV。整个过程大概半小时左右。</p>
<p>注意，安装<code>2.4.9</code>时中途可能会报错</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opencv<span class="number">-2.4</span><span class="number">.9</span>/modules/gpu/src/nvidia/core/NCVPixelOperations.hpp(<span class="number">51</span>): error: a storage <span class="keyword">class</span> <span class="symbol">is</span> <span class="symbol">not</span> <span class="symbol">allowed</span> <span class="symbol">in</span> <span class="symbol">an</span> <span class="symbol">explicit</span> <span class="symbol">specialization</span></span><br></pre></td></tr></table></figure>
<p>解决方法<a target="_blank" rel="noopener" href="http://code.opencv.org/issues/3814">在此</a>  下载 <a target="_blank" rel="noopener" href="http://code.opencv.org/projects/opencv/repository/revisions/feb74b125d7923c0bc11054b66863e1e9f753141/raw/modules/gpu/src/nvidia/core/NCVPixelOperations.hpp">NCVPixelOperations.hpp</a>， 替换掉opencv2.4.9内的文件， *并注释掉<code>opencv2_4_9.sh</code>中下载opencv包的代码<code>, 重新执行</code>sudo .&#x2F;opencv2_4_9.sh&#96;.</p>
<h1 id="6-安装Caffe所需要的Python环境"><a href="#6-安装Caffe所需要的Python环境" class="headerlink" title="6. 安装Caffe所需要的Python环境"></a>6. 安装Caffe所需要的Python环境</h1><h2 id="6-1-安装anaconda包"><a href="#6-1-安装anaconda包" class="headerlink" title="6.1 安装anaconda包"></a>6.1 安装anaconda包</h2><p><a target="_blank" rel="noopener" href="http://continuum.io/downloads">在此</a>下载最新的安装包, 用默认设置安装在用户目录下。</p>
<h2 id="6-2-安装python依赖库"><a href="#6-2-安装python依赖库" class="headerlink" title="6.2 安装python依赖库"></a>6.2 安装python依赖库</h2><p>打开新的终端, 用<code>which python</code>和<code>which pip</code>确定使用的是anaconda提供的python环境，然后进入<code>caffe_root/python</code>, 执行下列命令</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> req <span class="keyword">in</span> <span class="constructor">$(<span class="params">cat</span> <span class="params">requirements</span>.<span class="params">txt</span>)</span>; <span class="keyword">do</span> pip install $req; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="6-3-修正Anaconda存在的bug"><a href="#6-3-修正Anaconda存在的bug" class="headerlink" title="6.3 修正Anaconda存在的bug"></a>6.3 修正Anaconda存在的bug</h2><p>加入在编译或者运行caffe时遇到这样的错误</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>lib<span class="regexp">/x86_64-linux-gnu/</span>libx264.so.<span class="number">142</span>:undefined reference to <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<p>那么请删除掉<code>anaconda/lib</code>中的<code>libm.*</code>. 参考<a target="_blank" rel="noopener" href="https://github.com/BVLC/caffe/issues/985#issuecomment-53533769">this issue</a></p>
<p>实际编译caffe的时候还碰到anaconda和系统的libreadline冲突的状况，需要conda remove readline （感谢@jastarex ）.</p>
<h2 id="6-4-添加Anaconda-Library-Path"><a href="#6-4-添加Anaconda-Library-Path" class="headerlink" title="6.4 添加Anaconda Library Path"></a>6.4 添加Anaconda Library Path</h2><p>这里需要注意，在运行Caffe时，可能会报一些找不到<code>libxxx.so</code>的错误，而用 <code>locate libxxx.so</code>命令发现已经安装在anaconda中，这时首先想到的是在<code>/etc/ld.so.conf.d/</code> 下面将 <code>your_anaconda_path/lib</code> 加入 <code>LD_LIBRARY_PATH</code>中。 但是<em>这样做可能导致登出后无法再进入桌面！！！</em>原因（猜测）可能是anaconda的lib中有些内容于系统自带的lib产生冲突。</p>
<p>正确的做法是：为了不让系统在启动时就将anaconda&#x2F;lib加入系统库目录，可以在用户自己的<code>~/.bashrc</code> 中添加library path， 比如我就在最后添加了两行</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add library path</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">&quot;<span class="variable">$LD_LIBRARY_PATH</span>:your_anaconda_path/lib&quot;</span></span><br></pre></td></tr></table></figure>
<p>开启另一个终端后即生效，并且重启后能够顺利加载lightdm, 进入桌面环境。</p>
<h1 id="7-安装MATLAB"><a href="#7-安装MATLAB" class="headerlink" title="7. 安装MATLAB"></a>7. 安装MATLAB</h1><p>Caffe提供了MATLAB接口， 有需要用MATLAB的同学可以额外安装MATLAB。 安装教程请自行搜索。</p>
<p>安装完成后<a target="_blank" rel="noopener" href="http://www.linuxidc.com/Linux/2011-01/31632.htm">添加图标</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /usr/share/applications/Matlab.desktop</span><br></pre></td></tr></table></figure>
<p>输入以下内容</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Desktop Entry]</span></span><br><span class="line"><span class="attr">Type</span>=Application</span><br><span class="line"><span class="attr">Name</span>=Matlab</span><br><span class="line"><span class="attr">GenericName</span>=Matlab R2013b</span><br><span class="line"><span class="attr">Comment</span>=Matlab:The Language of Technical Computing</span><br><span class="line"><span class="attr">Exec</span>=sh /usr/local/MATLAB/R2013b/bin/matlab -desktop</span><br><span class="line"><span class="attr">Icon</span>=/usr/local/MATLAB/Matlab.png</span><br><span class="line"><span class="attr">Terminal</span>=<span class="literal">false</span></span><br><span class="line"><span class="attr">Categories</span>=Development<span class="comment">;Matlab;</span></span><br></pre></td></tr></table></figure>


<p>(I use the R2013b patched package. First you should uncompress the .iso file. Then use sudo cp to copy the patch file)</p>
<h1 id="8-编译Caffe"><a href="#8-编译Caffe" class="headerlink" title="8. 编译Caffe"></a>8. 编译Caffe</h1><h2 id="8-1-编译主程序"><a href="#8-1-编译主程序" class="headerlink" title="8.1 编译主程序"></a>8.1 编译主程序</h2><p>终于完成了所有环境的配置，可以愉快的编译Caffe了！ 进入caffe根目录， 首先复制一份<code>Makefile.config</code>, 然后修改里面的内容，主要需要修改的参数包括</p>
<ul>
<li>CPU_ONLY 是否只使用CPU模式，没有GPU没安装CUDA的同学可以打开这个选项</li>
<li>BLAS (使用intel mkl还是atlas)</li>
<li>MATLAB_DIR 如果需要使用MATLAB wrapper的同学需要指定matlab的安装路径, 如我的路径为 <code>/usr/local/MATLAB/R2013b</code> (注意该目录下需要包含bin文件夹，bin文件夹里应该包含mex二进制程序)</li>
<li>DEBUG 是否使用debug模式，打开此选项则可以在eclipse或者NSight中debug程序</li>
</ul>
<p>完成设置后， 开始编译</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make all -j4</span><br><span class="line">make <span class="built_in">test</span></span><br><span class="line">make runtest</span><br></pre></td></tr></table></figure>
<p>注意 <code>-j4</code> 是指使用几个线程来同时编译， 可以加快速度， j后面的数字可以根据CPU core的个数来决定， 我的CPU使4核， 所以-j4.</p>
<h2 id="8-2-编译Matlab-wrapper"><a href="#8-2-编译Matlab-wrapper" class="headerlink" title="8.2 编译Matlab wrapper"></a>8.2 编译Matlab wrapper</h2><p>执行如下命令</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make matcaffe</span></span><br></pre></td></tr></table></figure>
<p>然后就可以跑官方的matlab demo啦。</p>
<h2 id="8-3-编译Python-wrapper"><a href="#8-3-编译Python-wrapper" class="headerlink" title="8.3 编译Python wrapper"></a>8.3 编译Python wrapper</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">make pycaffe</span></span><br></pre></td></tr></table></figure>
<p>然后基本就全部安装完拉.</p>
<p>接下来大家尽情地跑demo吧～</p>
<h1 id="原文copy-完毕，接下来参照这里来跑Mnist。具体过程Copy如下："><a href="#原文copy-完毕，接下来参照这里来跑Mnist。具体过程Copy如下：" class="headerlink" title="原文copy 完毕，接下来参照这里来跑Mnist。具体过程Copy如下："></a>原文copy 完毕，接下来参照<a target="_blank" rel="noopener" href="http://blog.csdn.net/fengbingchun/article/details/49615883">这里</a>来跑Mnist。具体过程Copy如下：</h1><ol>
<li><p>将终端定位到Caffe根目录；</p>
</li>
<li><p>下载MNIST数据库并解压缩：$ .&#x2F;data&#x2F;mnist&#x2F;get_mnist.sh</p>
</li>
<li><p>将其转换成Lmdb数据库格式：$ .&#x2F;examples&#x2F;mnist&#x2F;create_mnist.sh 执行完此shell脚本后，会在.&#x2F;examples&#x2F;mnist下增加两个新目录，mnist_test_lmdb和mnist_train_lmdb</p>
</li>
<li><p>train model：$ .&#x2F;examples&#x2F;mnist&#x2F;train_lenet.sh</p>
</li>
<li><p>使用LeNet网络(《Gradient-BasedLearning Applied to Document Recognition》)；</p>
</li>
<li><p>使用.&#x2F;examples&#x2F;mnist&#x2F;lenet_train_test.prototxtmodel；</p>
</li>
<li><p>使用.&#x2F;examples&#x2F;mnist&#x2F;lenet_solver.prototxtmodel；</p>
</li>
<li><p>执行train_lenet.sh脚本，会调用.&#x2F;build&#x2F;tools目录下的caffe执行文件，此执行文件的实现是.&#x2F;tools目录下的caffe.cpp文件；</p>
</li>
<li><p>执行此脚本后，会生成几个文件，其中.&#x2F;examples&#x2F;mnist&#x2F;lenet_iter_10000.caffemodel则是最终训练生成的model文件；</p>
</li>
<li><p>以上默认的是在GPU模式下运行，如果想让其在CPU模式下运行，只需将lenet_solver.prototxt文件中的solver_mode字段值由原来的GPU改为CPU即可；</p>
</li>
</ol>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/08/31/%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8Kindle/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          优雅地使用Kindle
        
      </div>
    </a>
  
  
    <a href="/2016/08/25/%E4%B8%BAHG255D%E7%BC%96%E8%AF%91OpenWRT/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">为HG255D编译OpenWRT</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<div class="share">
	<!-- baidu_share Button BEGIN -->
	<div class="bdsharebuttonbox">
   	<a href="#" class="bds_more" data-cmd="more"></a>
   	<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
   	<a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
   	<a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
   	<a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
   	<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
  </div>
	<script>
 	window._bd_share_config={
 		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
 	</script>
	<!-- baidu_share Button END -->
</div>








    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="返回顶部">T<i class="fa fa-arrow-up"></i></a>
    <a href="#ds-thread" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部">B<i class="fa fa-arrow-down"></i></a>
    </div>

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2024 kangqingfei
    	</div>
    	<div class="footer-right">
    		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
    	</div>
    </div>
    <div class="visit">
      <span id="site-visit">站点访问量:
        <span id="busuanzi_value_site_pv"></span> /
        <span id="busuanzi_value_site_uv"></span>
      </span>
      <span id="page-visit">, 本页阅读量:
        <span id="busuanzi_value_page_pv"></span>
      </span>
    </div>
  </div>
</footer>

    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/jquery-1.9.1.min.js"></script>


<script src="/js/require-2.1.6.js"></script>


<script src="/js/main.js"></script>







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部">T<i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部">B<i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  </div>
</body>
</html>