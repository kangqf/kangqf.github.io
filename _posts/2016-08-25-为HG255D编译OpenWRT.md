---
title: 为HG255D编译OpenWRT
categories:
  - config
tags:
  - OpenWrt
  - HG255D
date: 2016-08-25 16:37:15
---
## 大概一个半月之前，入手了一个 HG255D用来刷OpenWRT，主要是有两个目的：一是本来宿舍的交换机没了想买个来替代交换机，二是买个通用机型来熟悉一下OpenWRt的编译流程。基本上两个目的都达到了，这里撰文记录一下为HG255D编译OpenWRT的流程，以及遇到的一些问题，还有一些OpenWRT的基本的概念。还有就是想给使用HG255D的同学一些刷机的指导。

1. 硬件。HG255D 是华为的一款路由器，支持 USB，而且有4个LAN口，最主要的是便宜-> 20包邮，而且它的折腾教程是相当的丰富。从OpenWRT官网的数据可以知道它的硬件信息大概如下
  * CPU Ralink RT3052 MIPS 24K @384 MHz
  * RAM 	32 MiB
  * Flash  S29GL128P  128(sectors)X128(Kbytes)=16Mbytes
  * Wireless	Ralink APSoC RT2860 b/g/n 2T2R (integrated)
  * Switch	Integrated 6 Port Fast Ethernet Switch
  * USB	 Yes (1 Port)
  * Serial	Yes
  * JTAG	Yes
当然还有拆解的帖子在[这里](http://www.right.com.cn/forum/thread-153163-1-1.html)
<!-- more -->
2. 获取固件。HG255D是一款配置较高的路由器，不用硬改就可以直接刷上OpenWRT，因此我们可以直接在OpenWRT官网找到[它的固件](http://downloads.openwrt.org.cn/OpenWrt-DreamBox/HG255D/)，或者在[这里](https://downloads.openwrt.org/barrier_breaker/14.07/ramips/rt305x/)找到它的固件。

3. 编译固件。
  1. 主要参照[这个文章](http://colesmith.space/2015/09/28/build-openwrt-for-hg255d.html)来操作。
  2. 修改设备的型号参照[这里](http://zhiwei.li/text/2016/04/24/%E4%B8%BA%E5%8D%8E%E4%B8%BAhg255d%E7%BC%96%E8%AF%91openwrt/)
  3. 添加一些高级的功能参照[这里](http://www.jianshu.com/p/66c7b0969a31)
  4. 添加USB支持参照[这里](http://www.tuicool.com/articles/IJ32maI)
  5. 技巧。需要哪些包，不需要哪些包，需要自己慢慢的尝试，然后修改需要的包，然后重新编译，还要考虑文件的大小的限制，不能所有的软件全部都弄上，反正我至少试了十几次才得到自己满意的固件。在一开始没有USB的支持然后，按照参考文章编译出来还是没有USB的支持，最后干脆把包里带USB的软件都安装上才有了USB的支持。

4. 刷机。修改 UBoot 参考[这里](http://zhiwei.li/text/2016/04/24/%E5%8D%8E%E4%B8%BAhg255d%E6%9B%B4%E6%96%B0uboot%E5%8F%8Aopenwrt/)，
